<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Bullet Heart Run ‚Äî Meme Boss Edition</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    html, body {
      margin: 0;
      background: #000;
      color: #fff;
      font-family: monospace;
      image-rendering: pixelated;
      overflow: hidden;
    }
    canvas {
      display: block;
      width: 960px;
      height: 720px;
      border: 4px solid #fff;
      background: #070606;
    }
    #adminPanel {
      position: absolute;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      background: #111;
      padding: 12px;
      border: 2px solid #ffd166;
      display: none;
      z-index: 10;
    }
    #adminPanel input, #adminPanel button, #adminPanel select {
      margin: 4px;
    }
    #equip {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: #222;
      padding: 12px;
      border: 2px solid #fff;
      display: none;
      z-index: 9;
    }
  </style>
</head>
<body>
  <canvas id="game" width="960" height="720"></canvas>

  <!-- Admin Panel -->
  <div id="adminPanel">
    <div><b>Admin Panel</b></div>
    <input id="announceInput" placeholder="Global announcement" />
    <button onclick="announce()">Announce</button>
    <button onclick="spawnChest()">Spawn Chest</button>
    <button onclick="healPlayer()">Heal Player</button>
    <select id="bossSelect">
      <option value="shrek">Shrekonator</option>
      <option value="cheesus">Cheesus</option>
      <option value="cluck">Cluckthulhu</option>
    </select>
    <button onclick="spawnMemeBoss()">Spawn Meme Boss</button>
  </div>

  <!-- Equip Panel -->
  <div id="equip">
    <div><b>Equip</b></div>
    <div id="weapons"></div>
    <div id="buffs"></div>
    <button onclick="closeEquip()">Close</button>
  </div>

  <script>
    const canvas = document.getElementById('game');
    const ctx = canvas.getContext('2d');
    let keys = new Set();
    let heart = { x: 480, y: 540, r: 6, hp: 50, max: 50, i: 0 };
    let boss = null;
    let bullets = [], chests = [], buffs = [], weapons = [], turn = 'player', time = 0;
    let adminCode = '', adminUnlocked = false;

    document.addEventListener('keydown', e => {
      keys.add(e.key);
      if (!adminUnlocked) {
        adminCode += e.key;
        if (adminCode.replace(/[^67]/g, '').endsWith('676767')) {
          document.getElementById('adminPanel').style.display = 'block';
          adminUnlocked = true;
        }
      }
      if (e.key === 'e') document.getElementById('equip').style.display = 'block';
      if (e.key === 'Enter') checkChest();
    });

    document.addEventListener('keyup', e => keys.delete(e.key));

    function announce() {
      const msg = document.getElementById('announceInput').value;
      alert("üì¢ " + msg);
    }

    function spawnChest() {
      chests.push({ x: Math.random() * 900 + 30, y: Math.random() * 600 + 60, opened: false });
    }

    function healPlayer() {
      heart.hp = heart.max;
    }

    function spawnMemeBoss() {
      const type = document.getElementById('bossSelect').value;
      boss = { type, hp: 100, max: 100 };
      alert(`‚öîÔ∏è ${type.toUpperCase()} enters the arena!`);
    }

    function closeEquip() {
      document.getElementById('equip').style.display = 'none';
    }

    function checkChest() {
      for (const c of chests) {
        const dx = heart.x - c.x, dy = heart.y - c.y;
        if (Math.sqrt(dx * dx + dy * dy) < 20 && !c.opened) {
          c.opened = true;
          alert("üéÅ Chest opened! You found a Rage Tonic.");
          buffs.push({ name: "Rage Tonic", effect: "x1.5 dmg" });
        }
      }
    }

    function update(dt) {
      time += dt;
      if (keys.has('ArrowLeft')) heart.x -= 200 * dt;
      if (keys.has('ArrowRight')) heart.x += 200 * dt;
      if (keys.has('ArrowUp')) heart.y -= 200 * dt;
      if (keys.has('ArrowDown')) heart.y += 200 * dt;
      heart.x = Math.max(heart.r, Math.min(960 - heart.r, heart.x));
      heart.y = Math.max(heart.r, Math.min(720 - heart.r, heart.y));
    }

    function draw() {
      ctx.fillStyle = '#000';
      ctx.fillRect(0, 0, 960, 720);

      ctx.fillStyle = '#fff';
      ctx.beginPath();
      ctx.arc(heart.x, heart.y, heart.r, 0, Math.PI * 2);
      ctx.fill();

      if (boss) {
        ctx.fillStyle = '#ffd166';
        ctx.font = '16px monospace';
        ctx.fillText(`Boss: ${boss.type.toUpperCase()} HP: ${boss.hp}/${boss.max}`, 20, 30);
        drawBossSprite(boss.type);
      }

      for (const c of chests) {
        ctx.fillStyle = c.opened ? '#aaa' : '#ffcc66';
        ctx.fillRect(c.x - 10, c.y - 10, 20, 20);
      }
    }

    function drawBossSprite(type) {
      const x = 480, y = 240;
      ctx.save();
      ctx.translate(x, y);
      if (type === 'shrek') {
        ctx.fillStyle = '#3f3';
        ctx.fillRect(-20, -20, 40, 40);
        ctx.fillStyle = '#000';
        ctx.fillRect(-10, -10, 6, 6);
        ctx.fillRect(4, -10, 6, 6);
      } else if (type === 'cheesus') {
        ctx.fillStyle = '#ff6';
        ctx.beginPath();
        ctx.arc(0, 0, 24, 0, Math.PI * 2);
        ctx.fill();
        ctx.fillStyle = '#fff';
        ctx.fillRect(-6, -6, 12, 2);
      } else if (type === 'cluck') {
        ctx.fillStyle = '#fff';
        ctx.beginPath();
        ctx.arc(0, 0, 20, 0, Math.PI * 2);
        ctx.fill();
        ctx.fillStyle = '#f00';
        ctx.fillRect(-4, -12, 8, 4);
      }
      ctx.restore();
    }

    let last = performance.now();
    function loop(now) {
      const dt = Math.min(0.033, (now - last) / 1000);
      last = now;
      update(dt);
      draw();
      requestAnimationFrame(loop);
    }
    requestAnimationFrame(loop);
  </script>
</body>
</html>

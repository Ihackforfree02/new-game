<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>UNDERTALE GOLD â€” Battle Prototype</title>
<style>
:root{--fg:#ffd166;--hp:#ff6b6b;--ui:#0b0b0b;--line:#262626;--emerald:#7affb7;--white:#fff;}
html,body{height:100%;margin:0;background:#000;color:var(--fg);font-family:ui-monospace,monospace;image-rendering:pixelated;overflow:hidden}
#stage{position:fixed;left:50%;top:50%;transform-origin:top left}
#wrap{position:relative;width:960px;height:720px}
canvas{display:block;width:960px;height:720px;border:4px solid #0a0a0f;background:#070606}
/* HUD */
#bossHUD{position:absolute;left:20px;top:22px;display:flex;flex-direction:column;gap:6px}
#bossName{font-size:13px}
#bossHP{height:10px;width:360px;background:#141414;border:1px solid #383838;position:relative}
#bossHPFill{position:absolute;inset:0 0 0 auto;background:var(--hp);width:100%}
#bossHPVal{font-size:12px;margin-top:2px}
#playerHUD{position:absolute;right:20px;top:22px;display:flex;flex-direction:column;gap:6px;align-items:flex-end}
#playerNameLabel{font-size:13px;color:var(--emerald)}
#pHP{height:10px;width:200px;background:#141414;border:1px solid #383838;position:relative}
#pHPFill{position:absolute;inset:0 0 0 auto;background:var(--emerald);width:100%}
#pHPVal{font-size:12px;margin-top:2px}
/* Bottom UI */
#uiBar{position:absolute;left:50%;bottom:8px;transform:translateX(-50%);width:920px;height:116px;background:var(--ui);border:2px solid var(--line);display:flex;align-items:center;justify-content:space-between;padding:0 18px}
.uiMenu{display:flex;gap:36px}
.uiBtn{display:flex;align-items:center;gap:10px;cursor:pointer;transition:transform .06s}
.uiBtn.sel{transform:translateY(-1px)}
.uiKey{width:20px;height:20px;border:2px solid #fff;display:flex;align-items:center;justify-content:center;font-weight:700}
.uiLabel{font-size:20px;letter-spacing:1px}
/* Arena */
#box{position:absolute;left:240px;top:420px;width:480px;height:180px;border:3px solid #fff;display:none}
/* Dialogue */
#bubble{position:absolute;left:50%;bottom:136px;transform:translateX(-50%);max-width:880px;min-height:84px;display:block;z-index:10}
.bub{position:relative;background:var(--ui);border:2px solid #fff;padding:10px 14px}
.bub::before,.bub::after{content:"";position:absolute;bottom:-12px;left:40px;width:0;height:0;border-left:8px solid transparent;border-right:8px solid transparent}
.bub::before{border-top:12px solid #fff;transform:translateY(2px)}
.bub::after{border-top:12px solid var(--ui)}
#bubbleText{white-space:pre-line;line-height:1.45;color:var(--fg)}
</style>
</head>
<body>
<div id="stage">
<div id="wrap">
  <canvas id="cv" width="960" height="720"></canvas>
  <div id="bossHUD">
    <div id="bossName">Golden Mantis</div>
    <div id="bossHP"><div id="bossHPFill"></div></div>
    <div id="bossHPVal">300/300</div>
  </div>
  <div id="playerHUD">
    <div id="playerNameLabel">Traveler</div>
    <div id="pHP"><div id="pHPFill"></div></div>
    <div id="pHPVal">20/20</div>
  </div>
  <div id="box"></div>
  <div id="bubble"><div class="bub"><div id="bubbleText">The Golden Mantis appears!</div></div></div>
  <div id="uiBar">
    <div class="uiMenu" id="uiMenu">
      <div class="uiBtn sel"><div class="uiKey">Z</div><div class="uiLabel">FIGHT</div></div>
      <div class="uiBtn"><div class="uiKey">A</div><div class="uiLabel">ACT</div></div>
      <div class="uiBtn"><div class="uiKey">I</div><div class="uiLabel">ITEM</div></div>
      <div class="uiBtn"><div class="uiKey">M</div><div class="uiLabel">MERCY</div></div>
    </div>
    <div id="uiCenter">Your turn.</div>
    <div id="uiRight"></div>
  </div>
</div>
</div>

<script>
const cv=document.getElementById('cv'),ctx=cv.getContext('2d');
let HEART={x:480,y:510,r:6,sp:280,i:0,hp:20,hpMax:20,color:'#ffd166'};
let currentBoss={name:'Golden Mantis',hp:300,hpMax:300,acts:[{name:'Check',run:()=>"It looks fierce."}],attacks:[],dialogue:['The Mantis descends.'],bg:'#1a1a2d'};
let bullets=[],turn='player',menu='root',selIx=0;

function updatePlayerHP(){document.getElementById('pHPFill').style.width=200*Math.max(0,HEART.hp/HEART.hpMax)+'px';document.getElementById('pHPVal').textContent=`${HEART.hp}/${HEART.hpMax}`;}
updatePlayerHP();
function updateBossHP(){document.getElementById('bossHPFill').style.width=360*Math.max(0,currentBoss.hp/currentBoss.hpMax)+'px';document.getElementById('bossHPVal').textContent=`${currentBoss.hp}/${currentBoss.hpMax}`;document.getElementById('bossName').textContent=currentBoss.name;}

let items=[{n:'Dew Petal',h:8},{n:'Amber Draught',h:14},{n:'Radiant Nectar',h:24}];
function openInventory(){menu='item';document.getElementById('bubbleText').textContent=(items.length?items.map((it,i)=>`${i+1}) ${it.n} (+${it.h} HP)`).join('\n'):'(Empty)')+'\n\nPress 1-9 to use, X to cancel';}
function closeInventory(){menu='root';document.getElementById('bubbleText').textContent='You step back.';}
function useItem(ix){const it=items[ix];if(!it)return;HEART.hp=Math.min(HEART.hpMax,HEART.hp+it.h);updatePlayerHP();items.splice(ix,1);closeInventory();endPlayerTurn();}

/* Input */
class Input{constructor(){this.k=new Set();this.down=new Set();addEventListener('keydown',e=>{this.k.add(e.key);this.down.add(e.key)});addEventListener('keyup',e=>{this.k.delete(e.key);});}
  is(k){return this.k.has(k)||this.k.has(String(k).toUpperCase());}
  consume(k){const had=this.down.has(k)||this.down.has(String(k).toUpperCase());this.down.delete(k);this.down.delete(String(k).toUpperCase());return had;}
  tick(){this.down.clear();}}
const input=new Input();

/* Menu */
const uiMenu=document.getElementById('uiMenu');
function setSelection(ix){[...uiMenu.children].forEach((c,i)=>c.classList.toggle('sel',i===ix));selIx=ix;}
function choose(){if(turn!=='player')return;const map=['FIGHT','ACT','ITEM','MERCY'];switch(map[selIx]){case'FIGHT':fightAction();break;case'ACT':actAction();break;case'ITEM':openInventory();break;case'MERCY':mercyAction();break;}}
function fightAction(){currentBoss.hp=Math.max(0,currentBoss.hp-20);updateBossHP();document.getElementById('bubbleText').textContent='You attack!';endPlayerTurn();}
function actAction(){document.getElementById('bubbleText').textContent=currentBoss.acts.map((a,i)=>`${i+1}) ${a.name}`).join('\n');menu='act';}
function mercyAction(){document.getElementById('bubbleText').textContent='They are not ready.';}

/* Events */
uiMenu.addEventListener('mousemove',e=>{const it=e.target.closest('.uiBtn');if(!it)return;const ix=[...uiMenu.children].indexOf(it);if(ix>=0)setSelection(ix);});
uiMenu.addEventListener('click',()=>choose());

/* Draw boss */
function drawBoss(ctx,t){
  // background
  ctx.fillStyle=currentBoss.bg; ctx.fillRect(0,0,960,720);
  // simple golden mantis with wings and glowing
  const x=480,y=250;
  ctx.save();
  ctx.shadowColor='#ffd166';ctx.shadowBlur=10;
  ctx.fillStyle='#b8902f';ctx.beginPath();ctx.moveTo(x-20,y);ctx.lineTo(x-60,y+40);ctx.lineTo(x-20,y+60);ctx.closePath();ctx.fill();
  ctx.beginPath();ctx.moveTo(x+20,y);ctx.lineTo(x+60,y+40);ctx.lineTo(x+20,y+60);ctx.closePath();ctx.fill();
  ctx.fillStyle='#e5bf4d';ctx.fillRect(x-5,y-10,10,40);
  ctx.beginPath();ctx.arc(x,y+50,12,0,Math.PI*2);ctx.fill();
  ctx.restore();
}

/* Draw heart */
function drawHeart(ctx,x,y,color='#ffd166',scale=1){
  ctx.save();ctx.translate(x,y);ctx.scale(scale,scale);
  const m=[[0,1,1,0],[1,1,1,1],[1,1,1,1],[0,1,1,0]];ctx.fillStyle=color;
  const s=4;for(let r=0;r<m.length;r++)for(let c=0;c<m[r].length;c++)if(m[r][c])ctx.fillRect((c-2)*s,(r-2)*s,s,s);ctx.restore();
}

/* Game loop */
let last=performance.now();
function loop(now){
  const dt=(now-last)/1000; last=now;
  input.tick();
  ctx.clearRect(0,0,960,720);
  drawBoss(ctx,now/1000);
  if(turn==='player'){if(input.is('ArrowLeft'))HEART.x-=5;if(input.is('ArrowRight'))HEART.x+=5;if(input.is('ArrowUp'))HEART.y-=5;if(input.is('ArrowDown'))HEART.y+=5;}
  drawHeart(ctx,HEART.x,HEART.y,HEART.color,1);
  requestAnimationFrame(loop);
}
requestAnimationFrame(loop);

/* End turn */
function endPlayerTurn(){turn='enemy';setTimeout(()=>{turn='player';},800);}
</script>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Black Hole Starcatcher</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      overflow: hidden;
      background: radial-gradient(circle at center, #000010 0%, #000000 100%);
      font-family: sans-serif;
      color: white;
    }
    canvas {
      display: block;
    }
    #adminPanel {
      position: fixed;
      top: 20px;
      right: 20px;
      background: rgba(0,0,0,0.8);
      padding: 12px;
      border-radius: 10px;
      border: 1px solid #444;
      display: none;
      z-index: 10;
    }
    #adminPanel h3 {
      margin-top: 0;
      color: #7be3ff;
    }
    #adminPanel button {
      margin: 4px 0;
      padding: 6px 10px;
      background: #123;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }
  </style>
</head>
<body>
<canvas id="gameCanvas"></canvas>

<div id="adminPanel">
  <h3>Admin Panel</h3>
  <button onclick="state.lives = Infinity">Infinite Lives</button>
  <button onclick="spawnBoss()">Spawn Boss</button>
  <button onclick="state.abilities.push('expand')">Unlock: Expand</button>
  <button onclick="state.abilities.push('minis')">Unlock: Mini Holes</button>
  <button onclick="state.abilities.push('pulse')">Unlock: Gravity Pulse</button>
  <button onclick="state.abilities.push('slow')">Unlock: Time Warp</button>
  <button onclick="document.getElementById('adminPanel').style.display='none'">Close</button>
</div>

<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
let W = window.innerWidth;
let H = window.innerHeight;
canvas.width = W;
canvas.height = H;

const state = {
  x: W/2,
  y: H/2,
  radius: 80,
  lives: Infinity,
  keys: {},
  stars: [],
  enemies: [],
  boss: null,
  abilities: [],
  minis: [],
  adminCode: '',
  adminCount: 0
};

function spawnStar() {
  state.stars.push({
    x: Math.random() * W,
    y: -20,
    vx: (Math.random() - 0.5) * 2,
    vy: 2 + Math.random() * 2,
    r: 6 + Math.random() * 4
  });
}

function spawnBoss() {
  state.boss = {
    x: W/2,
    y: 100,
    hp: 100,
    tired: false,
    shots: []
  };
}

function drawBlackHole() {
  const g = ctx.createRadialGradient(state.x, state.y, state.radius/2, state.x, state.y, state.radius);
  g.addColorStop(0, '#7be3ff');
  g.addColorStop(1, '#000');
  ctx.fillStyle = g;
  ctx.beginPath();
  ctx.arc(state.x, state.y, state.radius, 0, Math.PI*2);
  ctx.fill();
}

function drawStar(s) {
  ctx.fillStyle = '#fff';
  ctx.beginPath();
  ctx.arc(s.x, s.y, s.r, 0, Math.PI*2);
  ctx.fill();
}

function drawBoss(b) {
  ctx.fillStyle = b.tired ? '#888' : '#f00';
  ctx.beginPath();
  ctx.arc(b.x, b.y, 40, 0, Math.PI*2);
  ctx.fill();
}

function drawShot(s) {
  ctx.fillStyle = '#ff0';
  ctx.beginPath();
  ctx.arc(s.x, s.y, 6, 0, Math.PI*2);
  ctx.fill();
}

function drawMini(m) {
  ctx.fillStyle = '#7be3ff';
  ctx.beginPath();
  ctx.arc(m.x, m.y, 20, 0, Math.PI*2);
  ctx.fill();
}

function update() {
  if (state.keys['ArrowLeft'] || state.keys['a']) state.x -= 5;
  if (state.keys['ArrowRight'] || state.keys['d']) state.x += 5;
  if (state.keys['ArrowUp'] || state.keys['w']) state.y -= 5;
  if (state.keys['ArrowDown'] || state.keys['s']) state.y += 5;

  state.stars.forEach((s, i) => {
    s.x += s.vx;
    s.y += s.vy;
    const dx = s.x - state.x;
    const dy = s.y - state.y;
    const dist = Math.sqrt(dx*dx + dy*dy);
    if (dist < state.radius) {
      state.stars.splice(i,1);
    }
  });

  if (state.boss) {
    if (!state.boss.tired && Math.random() < 0.05) {
      state.boss.shots.push({x: state.boss.x, y: state.boss.y, vx: (Math.random()-0.5)*4, vy: 3});
    }
    state.boss.shots.forEach((s, i) => {
      s.x += s.vx;
      s.y += s.vy;
      const dx = s.x - state.x;
      const dy = s.y - state.y;
      const dist = Math.sqrt(dx*dx + dy*dy);
      if (dist < state.radius) {
        state.boss.hp -= 5;
        state.boss.shots.splice(i,1);
        if (state.boss.hp <= 0) {
          state.boss.tired = true;
        }
      }
    });
    const dx = state.boss.x - state.x;
    const dy = state.boss.y - state.y;
    const dist = Math.sqrt(dx*dx + dy*dy);
    if (state.boss.tired && dist < state.radius + 40) {
      state.boss = null;
      state.radius += 20;
      state.minis.push({x: state.x+100, y: state.y});
    }
  }

  state.minis.forEach(m => {
    m.x += Math.sin(Date.now()/500) * 2;
    m.y += Math.cos(Date.now()/500) * 2;
  });

  if (Math.random() < 0.05) spawnStar();
}

function draw() {
  ctx.clearRect(0,0,W,H);
  drawBlackHole();
  state.stars.forEach(drawStar);
  if (state.boss) {
    drawBoss(state.boss);
    state.boss.shots.forEach(drawShot);
  }
  state.minis.forEach(drawMini);
}

function loop() {
  update();
  draw();
  requestAnimationFrame(loop);
}

window.addEventListener('keydown', e => {
  state.keys[e.key] = true;
  state.adminCode += e.key;
  if (state.adminCode.endsWith('67')) {
    state.adminCount++;
    state.adminCode = '';
  }
  if (state.adminCount >= 3) {
    document.getElementById('adminPanel').style.display = 'block';
    state.adminCount = 0;
  }
});
window.addEventListener('keyup', e => {
  state.keys[e.key] = false;
});

loop();
</script>
</body>
</html>
